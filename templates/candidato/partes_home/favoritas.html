<link rel="stylesheet" href="{{ url_for('static', filename='style/favoritos.css') }}">

{% if vagas_favoritas %}
<div class="vagas-favoritas-wrapper">
    <div class="title-container">
        <h2 class="title">
            <span class="star-icon">⭐</span>
            Vagas Favoritas
        </h2>
        <span class="badge">
            {{ vagas_favoritas|length }} favorita{{ 's' if vagas_favoritas|length != 1 else '' }}
        </span>
    </div>

    <div class="grid-container">
        {% for vaga in vagas_favoritas %}
        <div class="job-item">
            <div class="job-details">
                <div class="job-info">
                    <div class="job-header">
                        <div class="icon-container">
                            <img src="{{ url_for('static', filename='/img/vaga_job.png') }}" />
                        </div>
                        <div class="job-content">
                            <div class="job-title">
                                <a href="{{ url_for('vagas.detalhes_vaga', vaga_id=vaga.id) }}" class="link">
                                    <h3 class="job-title-text">
                                        {{ vaga.titulo }}
                                    </h3>
                                </a>
                                <button
                                    onclick="toggleFavorite('{{ vaga[0] }}', this)" 
                                    class="favorite-btn"
                                    data-favorited="{{ 'true' if vaga.is_favorita else 'false' }}" 
                                    title="{{ 'Remover dos favoritos' if vaga.is_favorita else 'Adicionar aos favoritos' }}">
                                    <span class="favorite-icon">{% if vaga.is_favorita %}⭐{% else %}☆{% endif %}</span>
                                </button>
                            </div>
                            <p class="company-info">
                                <span class="company-icon">🏢</span>
                                {{ vaga.empresa_nome }}
                            </p>
                            <p class="salary-info">
                                <span class="salary-icon">💰</span>
                                R$ {{ "%.2f"|format(vaga.salario) }}
                            </p>

                            {% if vaga.ja_candidatou %}
                            <div class="application-status">
                                <p class="status-text">
                                    <span>🎯</span> Você já se candidatou a esta vaga
                                    {% if vaga.posicao %}
                                    <span class="position">
                                        {{ vaga.posicao }}º posição
                                    </span>
                                    {% endif %}
                                </p>
                            </div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="job-description">
                        <p class="description-text">{{ vaga.descricao[:200] }}{% if vaga.descricao|length > 200 %}...{% endif %}</p>
                    </div>
                </div>

                <div class="match-container">
                    <div class="match-score">
                        <div class="score-text">{{ "%.0f"|format(vaga.score) }}%</div>
                        <p class="match-label">MATCH</p>
                    </div>

                    {% if not vaga.ja_candidatou %}
                    <a href="{{ url_for('candidaturas.candidatar', vaga_id=vaga.id) }}"
                        class="apply-btn">
                        <span class="apply-icon">🚀</span>
                        Candidatar-se
                    </a>
                    {% else %}
                    <div class="applied-status">
                        <div class="applied-text">
                            ✅ Candidatado
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% else %}
<div class="no-favorites">
    <div class="no-favorites-icon">
        <span class="star-icon">⭐</span>
    </div>
    <h3 class="no-favorites-title">Nenhuma vaga favorita ainda</h3>
    <p class="no-favorites-text">Favorite vagas interessantes para acompanhar mais facilmente!</p>
    <button onclick="showSection('principais')" class="explore-btn">
        🔍 Explorar Vagas
    </button>
</div>
{% endif %}
