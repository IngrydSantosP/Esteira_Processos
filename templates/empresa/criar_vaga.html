{% extends "base.html" %}

{% block title %}Criar Vaga{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-50">
    <!-- Header -->
    <div class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl flex items-center justify-center">
                        <span class="text-white font-bold text-lg">➕</span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent">
                            Criar Nova Vaga
                        </h1>
                        <p class="text-gray-500 text-sm">Cadastre uma nova oportunidade de trabalho</p>
                    </div>
                </div>
                <a href="{{ url_for('dashboard_empresa') }}"
                   class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-xl transition-all duration-300 flex items-center gap-2">
                    <span>⬅️</span>
                    Voltar ao Dashboard
                </a>
            </div>
        </div>
    </div>

    <div class="max-w-5xl mx-auto px-4 py-8">
        <!-- Progress Indicator -->
        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-8">
            <div class="flex items-center justify-center space-x-4">
                <div class="flex items-center cursor-pointer transition-all duration-300 hover:scale-105" onclick="mostrarSecao(1)" id="step-1">
                    <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-full flex items-center justify-center font-bold text-sm shadow-lg">1</div>
                    <span class="ml-3 text-sm font-medium text-green-600">Informações Essenciais</span>
                </div>
                <div class="w-12 h-1 bg-green-300 rounded-full" id="progress-1"></div>
                <div class="flex items-center cursor-pointer transition-all duration-300 hover:scale-105" onclick="mostrarSecao(2)" id="step-2">
                    <div class="w-10 h-10 bg-gray-300 text-gray-500 rounded-full flex items-center justify-center font-bold text-sm">2</div>
                    <span class="ml-3 text-sm font-medium text-gray-500">Requisitos e Descrição</span>
                </div>
                <div class="w-12 h-1 bg-gray-300 rounded-full" id="progress-2"></div>
                <div class="flex items-center cursor-pointer transition-all duration-300 hover:scale-105" onclick="mostrarSecao(3)" id="step-3">
                    <div class="w-10 h-10 bg-gray-300 text-gray-500 rounded-full flex items-center justify-center font-bold text-sm">3</div>
                    <span class="ml-3 text-sm font-medium text-gray-500">Score Personalizado</span>
                </div>
            </div>
        </div>

        <form method="POST" class="space-y-8">
            <!-- Seção 1: Informações Essenciais -->
            <div id="secao-1" class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                <div class="flex items-center gap-4 mb-6">
                    <div class="w-16 h-16 bg-gradient-to-br from-green-100 to-emerald-100 rounded-2xl flex items-center justify-center">
                        <span class="text-3xl">📋</span>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Informações Essenciais</h2>
                        <p class="text-gray-500">Dados fundamentais da vaga</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-grid-cols-2 gap-6">
                    <div class="md:col-span-2">
                        <label for="titulo" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>💼</span> Título da Vaga *
                        </label>
                        <input type="text" id="titulo" name="titulo" required
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                               placeholder="Ex: Desenvolvedor Full Stack Sênior">
                    </div>

                    <div>
                        <label for="salario_oferecido" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>💰</span> Salário Oferecido (R$) *
                        </label>
                        <input type="number" id="salario_oferecido" name="salario_oferecido" required step="0.01" min="0"
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                               placeholder="Ex: 8500.00">
                    </div>

                    <div>
                        <label for="nivel_experiencia" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>📈</span> Nível de Experiência *
                        </label>
                        <select id="nivel_experiencia" name="nivel_experiencia" required
                                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <option value="">Selecione o nível</option>
                            <option value="Estagiário">🎓 Estagiário</option>
                            <option value="Júnior">🌱 Júnior (0-2 anos)</option>
                            <option value="Pleno">🌳 Pleno (3-5 anos)</option>
                            <option value="Sênior">🚀 Sênior (5+ anos)</option>
                            <option value="Especialista">💡 Especialista</option>
                        </select>
                    </div>

                    <div>
                        <label for="tipo_vaga" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>🏠</span> Modalidade de Trabalho *
                        </label>
                        <select id="tipo_vaga" name="tipo_vaga" required
                                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                onchange="toggleEnderecoField()">
                            <option value="">Selecione a modalidade</option>
                            <option value="Presencial">🏢 Presencial</option>
                            <option value="Remoto">🏠 Remoto</option>
                            <option value="Híbrida">🔄 Híbrida</option>
                        </select>
                    </div>

                    <div>
                        <label for="regime_contratacao" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>🤝</span> Regime de Contratação *
                        </label>
                        <select id="regime_contratacao" name="regime_contratacao" required
                                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <option value="">Selecione o regime</option>
                            <option value="CLT">📜 CLT</option>
                            <option value="PJ">💼 PJ</option>
                            <option value="Estágio">📚 Estágio</option>
                            <option value="Freelancer">💰 Freelancer</option>
                        </select>
                    </div>

                    <!-- Campos de Localização (condicionais) -->
                    <div id="endereco_container" class="md:col-span-2 hidden">
                        <div class="bg-blue-50 rounded-xl p-4 border border-blue-200 mb-4">
                            <label class="flex items-center space-x-3 cursor-pointer">
                                <input type="checkbox" id="usar_endereco_empresa" name="usar_endereco_empresa" 
                                       class="w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"
                                       onchange="toggleEnderecoEmpresa()">
                                <span class="text-sm font-semibold text-gray-700 flex items-center gap-1">
                                    <span>🏢</span> Usar endereço da empresa
                                </span>
                            </label>
                        </div>

                        <div id="campos_endereco_vaga" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="md:col-span-2">
                                <label for="localizacao_endereco" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                                    <span>📍</span> Endereço Completo *
                                </label>
                                <input type="text" id="localizacao_endereco" name="localizacao_endereco"
                                       class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                       placeholder="Ex: Av. Paulista, 1000, Conj. 101">
                            </div>

                            <div>
                                <label for="localizacao_cidade" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                                    <span>🌆</span> Cidade *
                                </label>
                                <input type="text" id="localizacao_cidade" name="localizacao_cidade"
                                       class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                       placeholder="Ex: São Paulo">
                            </div>

                            <div>
                                <label for="localizacao_estado" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                                    <span>🗺️</span> Estado *
                                </label>
                                <select id="localizacao_estado" name="localizacao_estado"
                                        class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="">Selecione o estado</option>
                                    <option value="SP">São Paulo</option>
                                    <option value="RJ">Rio de Janeiro</option>
                                    <option value="MG">Minas Gerais</option>
                                    <option value="RS">Rio Grande do Sul</option>
                                    <option value="PR">Paraná</option>
                                    <option value="SC">Santa Catarina</option>
                                    <option value="BA">Bahia</option>
                                    <option value="GO">Goiás</option>
                                    <option value="PE">Pernambuco</option>
                                    <option value="CE">Ceará</option>
                                    <option value="DF">Distrito Federal</option>
                                    <option value="ES">Espírito Santo</option>
                                    <option value="MT">Mato Grosso</option>
                                    <option value="MS">Mato Grosso do Sul</option>
                                    <option value="PA">Pará</option>
                                    <option value="PB">Paraíba</option>
                                    <option value="AM">Amazonas</option>
                                    <option value="RN">Rio Grande do Norte</option>
                                    <option value="AL">Alagoas</option>
                                    <option value="PI">Piauí</option>
                                    <option value="AC">Acre</option>
                                    <option value="AP">Amapá</option>
                                    <option value="RO">Rondônia</option>
                                    <option value="RR">Roraima</option>
                                    <option value="SE">Sergipe</option>
                                    <option value="TO">Tocantins</option>
                                    <option value="MA">Maranhão</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label for="categoria_id" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>🏷️</span> Categoria da Vaga
                        </label>
                        <select id="categoria_id" name="categoria_id"
                                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                onchange="toggleNovaCategoria()">
                            <option value="">Selecione uma categoria</option>
                            {% for categoria in categorias %}
                            <option value="{{ categoria.id }}">{{ categoria.nome }}</option>
                            {% endfor %}
                            <option value="nova">✨ Adicionar nova categoria</option>
                        </select>
                    </div>

                    <div>
                        <label for="urgencia_contratacao" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>⚡</span> Urgência da Contratação
                        </label>
                        <select id="urgencia_contratacao" name="urgencia_contratacao"
                                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <option value="">Selecione a urgência</option>
                            <option value="Imediata">🚨 Imediata</option>
                            <option value="Em até 30 dias">⏰ Em até 30 dias</option>
                            <option value="Em até 60 dias">📅 Em até 60 dias</option>
                            <option value="Sem urgência">🕐 Sem urgência</option>
                        </select>
                    </div>

                    <div id="nova_categoria_container" class="md:col-span-2 hidden">
                        <label for="nova_categoria" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>✨</span> Nova Categoria
                        </label>
                        <input type="text" id="nova_categoria" name="nova_categoria"
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                               placeholder="Ex: Inteligência Artificial">
                    </div>
                </div>
            </div>

            <!-- Seção 2: Requisitos e Descrição -->
            <div id="secao-2" class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hidden">
                <div class="flex items-center gap-4 mb-6">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-2xl flex items-center justify-center">
                        <span class="text-3xl">📝</span>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Requisitos e Descrição</h2>
                        <p class="text-gray-500">Defina o que procura no candidato ideal</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <div>
                        <label for="descricao" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>📄</span> Descrição da Vaga *
                        </label>
                        <textarea id="descricao" name="descricao" required rows="4"
                                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                                  placeholder="Descreva as principais responsabilidades, benefícios e ambiente de trabalho..."></textarea>
                        <div class="mt-1 text-xs text-gray-500 flex items-center gap-1">
                            <span>💡</span> Seja claro e objetivo para atrair candidatos qualificados
                        </div>
                    </div>

                    <div>
                        <label for="requisitos" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>⚡</span> Requisitos Obrigatórios *
                        </label>
                        <textarea id="requisitos" name="requisitos" required rows="4"
                                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                                  placeholder="Liste as habilidades técnicas, experiências e qualificações essenciais..."></textarea>
                        <div class="mt-1 text-xs text-gray-500 flex items-center gap-1">
                            <span>🎯</span> Foque apenas no que é realmente indispensável
                        </div>
                    </div>

                    <div>
                        <label for="diferenciais" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>🌟</span> Diferenciais Desejáveis
                        </label>
                        <textarea id="diferenciais" name="diferenciais" rows="3"
                                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                                  placeholder="Ex: Inglês fluente, certificações, experiência com metodologias ágeis..."></textarea>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="formacao_minima" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                                <span>🎓</span> Formação Mínima *
                            </label>
                            <select id="formacao_minima" name="formacao_minima" required
                                    class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">Selecione a formação</option>
                                <option value="Ensino Fundamental">Ensino Fundamental</option>
                                <option value="Ensino Médio">Ensino Médio</option>
                                <option value="Técnico">Técnico</option>
                                <option value="Graduação">Graduação</option>
                                <option value="Pós-graduação">Pós-graduação</option>
                            </select>
                        </div>

                        <div>
                            <label for="carga_horaria" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                                <span>⏱️</span> Carga Horária *
                            </label>
                            <select id="carga_horaria" name="carga_horaria" required
                                    class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">Selecione a carga horária</option>
                                <option value="20h">20h semanais</option>
                                <option value="30h">30h semanais</option>
                                <option value="40h">40h semanais</option>
                                <option value="44h">44h semanais</option>
                                <option value="Flexível">🔄 Flexível</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label for="beneficios" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-1">
                            <span>🎁</span> Principais Benefícios
                        </label>
                        <textarea id="beneficios" name="beneficios" rows="2"
                                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                                  placeholder="Ex: Vale alimentação, plano de saúde, home office flexível..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Seção 3: Metodologia de Score -->
            <div id="secao-3" class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hidden">
                <div class="flex items-center gap-4 mb-6">
                    <div class="w-16 h-16 bg-gradient-to-br from-purple-100 to-pink-100 rounded-2xl flex items-center justify-center">
                        <span class="text-3xl">🎯</span>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Metodologia de Score</h2>
                        <p class="text-gray-500">Configure como os candidatos serão avaliados</p>
                    </div>
                </div>

                <!-- Template de Score -->
                <div class="mb-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-1">
                        <span>🎛️</span> Template de Avaliação
                    </label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <select id="template_score" name="template_score" 
                                class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                onchange="aplicarTemplateScore()">
                            <option value="">Selecione um template</option>
                            <option value="equilibrado">⚖️ Padrão Equilibrado</option>
                            <option value="tecnico">💻 Foco Técnico</option>
                            <option value="startup">🚀 Startup Flexível</option>
                            <option value="tradicional">🏢 Empresa Tradicional</option>
                            <option value="remoto">🏠 Remoto First</option>
                            <option value="vendas">📊 Vendas & Relacionamento</option>
                            <option value="gestao">👔 Gestão & Liderança</option>
                            <option value="personalizado">⚙️ Personalizado</option>
                        </select>
                        <button type="button" onclick="resetarPesos()" 
                                class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2">
                            <span>🔄</span> Resetar
                        </button>
                    </div>
                </div>

                <!-- Configuração de Pesos -->
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span>⚖️</span> Distribuição de Pesos (Total: <span id="total-peso">100</span>%)
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label for="peso_salarial" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center justify-between">
                                    <span class="flex items-center gap-1">💰 Expectativa Salarial</span>
                                    <span class="text-purple-600 font-bold"><span id="valor_salarial">20</span>%</span>
                                </label>
                                <input type="range" id="peso_salarial" name="peso_salarial" min="0" max="50" value="20" 
                                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-purple"
                                       oninput="atualizarPeso('salarial', this.value)">
                            </div>

                            <div>
                                <label for="peso_requisitos" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center justify-between">
                                    <span class="flex items-center gap-1">⚡ Requisitos Técnicos</span>
                                    <span class="text-purple-600 font-bold"><span id="valor_requisitos">40</span>%</span>
                                </label>
                                <input type="range" id="peso_requisitos" name="peso_requisitos" min="0" max="60" value="40" 
                                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-purple"
                                       oninput="atualizarPeso('requisitos', this.value)">
                            </div>

                            <div>
                                <label for="peso_experiencia" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center justify-between">
                                    <span class="flex items-center gap-1">📈 Experiência</span>
                                    <span class="text-purple-600 font-bold"><span id="valor_experiencia">15</span>%</span>
                                </label>
                                <input type="range" id="peso_experiencia" name="peso_experiencia" min="0" max="40" value="15" 
                                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-purple"
                                       oninput="atualizarPeso('experiencia', this.value)">
                            </div>
                        </div>

                        <div class="space-y-4">
                            <div>
                                <label for="peso_diferenciais" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center justify-between">
                                    <span class="flex items-center gap-1">🌟 Diferenciais</span>
                                    <span class="text-purple-600 font-bold"><span id="valor_diferenciais">10</span>%</span>
                                </label>
                                <input type="range" id="peso_diferenciais" name="peso_diferenciais" min="0" max="30" value="10" 
                                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-purple"
                                       oninput="atualizarPeso('diferenciais', this.value)">
                            </div>

                            <div>
                                <label for="peso_localizacao" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center justify-between">
                                    <span class="flex items-center gap-1">📍 Localização</span>
                                    <span class="text-purple-600 font-bold"><span id="valor_localizacao">10</span>%</span>
                                </label>
                                <input type="range" id="peso_localizacao" name="peso_localizacao" min="0" max="25" value="10" 
                                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-purple"
                                       oninput="atualizarPeso('localizacao', this.value)">
                            </div>

                            <div>
                                <label for="peso_formacao" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center justify-between">
                                    <span class="flex items-center gap-1">🎓 Formação</span>
                                    <span class="text-purple-600 font-bold"><span id="valor_formacao">5</span>%</span>
                                </label>
                                <input type="range" id="peso_formacao" name="peso_formacao" min="0" max="25" value="5" 
                                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-purple"
                                       oninput="atualizarPeso('formacao', this.value)">
                            </div>
                        </div>
                    </div>

                    <!-- Indicador Visual -->
                    <div class="mt-6">
                        <div class="bg-white rounded-lg p-4 border border-gray-200">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-gray-700">Total dos Pesos:</span>
                                <span id="status-peso" class="text-sm font-bold text-green-600">✅ Válido (100%)</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div id="barra-progresso" class="bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all duration-300" style="width: 100%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Explicação -->
                    <div class="mt-4 bg-blue-50 rounded-lg p-4 border border-blue-200">
                        <h4 class="text-sm font-bold text-blue-800 mb-2 flex items-center gap-1">
                            <span>💡</span> Como funciona o score:
                        </h4>
                        <ul class="text-xs text-blue-700 space-y-1">
                            <li>• <strong>Expectativa Salarial:</strong> Compatibilidade entre pretensão do candidato e salário oferecido</li>
                            <li>• <strong>Requisitos Técnicos:</strong> Alinhamento do perfil com habilidades exigidas</li>
                            <li>• <strong>Experiência:</strong> Anos de experiência e senioridade do candidato</li>
                            <li>• <strong>Diferenciais:</strong> Habilidades extras que agregam valor (certificações, idiomas)</li>
                            <li>• <strong>Localização:</strong> Proximidade geográfica (para vagas presenciais)</li>
                            <li>• <strong>Formação:</strong> Nível educacional compatível com a vaga</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Navegação -->
            <div class="flex justify-between items-center" id="sectionNavigation">
                <button type="button" onclick="secaoAnterior()" id="btnAnterior"
                        class="bg-gray-500 hover:bg-gray-600 text-white py-3 px-6 rounded-xl font-semibold transition-all duration-300 flex items-center gap-2" 
                        style="display: none;">
                    <span>⬅️</span> Anterior
                </button>
                <div class="flex-1"></div>
                <button type="button" onclick="proximaSecao()" id="btnProximo"
                        class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white py-3 px-6 rounded-xl font-semibold transition-all duration-300 flex items-center gap-2">
                    Próximo <span>➡️</span>
                </button>
            </div>

            <!-- Botões Finais -->
            <div class="flex flex-col sm:flex-row gap-4" id="actionButtons" style="display: none;">
                <button type="submit"
                        class="flex-1 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white py-4 px-8 rounded-xl font-semibold text-lg transition-all duration-300 flex items-center justify-center gap-3 shadow-lg">
                    <span class="text-xl">🚀</span>
                    Criar Vaga
                </button>
                <a href="{{ url_for('dashboard_empresa') }}"
                   class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-4 px-8 rounded-xl font-semibold text-lg transition-all duration-300 text-center flex items-center justify-center gap-3 shadow-lg">
                    <span class="text-xl">❌</span>
                    Cancelar
                </a>
            </div>
        </form>
    </div>
</div>

<script>
// Campos obrigatórios ocultos com valores padrão
const camposOcultos = {
    'turno_trabalho': 'Comercial',
    'idiomas_exigidos': '',
    'disponibilidade_viagens': false,
    'data_limite_candidatura': null,
    'data_congelamento_agendado': null
};

// Adicionar campos ocultos no envio
document.querySelector('form').addEventListener('submit', function(e) {
    Object.keys(camposOcultos).forEach(campo => {
        if (!document.querySelector(`[name="${campo}"]`)) {
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = campo;
            input.value = camposOcultos[campo];
            this.appendChild(input);
        }
    });
});

function toggleEnderecoField() {
    const tipoVaga = document.getElementById('tipo_vaga').value;
    const enderecoContainer = document.getElementById('endereco_container');
    const camposEndereco = document.querySelectorAll('#campos_endereco_vaga input, #campos_endereco_vaga select');

    if (tipoVaga === 'Presencial' || tipoVaga === 'Híbrida') {
        enderecoContainer.classList.remove('hidden');
        camposEndereco.forEach(campo => {
            campo.required = true;
        });
    } else {
        enderecoContainer.classList.add('hidden');
        camposEndereco.forEach(campo => {
            campo.required = false;
            campo.value = '';
        });
    }
}

function toggleNovaCategoria() {
    const categoriaSelect = document.getElementById('categoria_id');
    const novaContainer = document.getElementById('nova_categoria_container');
    const novaInput = document.getElementById('nova_categoria');

    if (categoriaSelect.value === 'nova') {
        novaContainer.classList.remove('hidden');
        novaInput.required = true;
        novaInput.focus();
    } else {
        novaContainer.classList.add('hidden');
        novaInput.required = false;
        novaInput.value = '';
    }
}

function toggleEnderecoEmpresa() {
    const checkbox = document.getElementById('usar_endereco_empresa');
    const camposEndereco = document.getElementById('campos_endereco_vaga');

    if (checkbox.checked) {
        fetch('/empresa/endereco')
            .then(response => response.json())
            .then(data => {
                if (data.endereco) {
                    document.getElementById('localizacao_endereco').value = data.endereco || '';
                    document.getElementById('localizacao_cidade').value = data.cidade || '';
                    document.getElementById('localizacao_estado').value = data.estado || '';
                }
            })
            .catch(error => console.error('Erro ao buscar endereço:', error));

        camposEndereco.style.opacity = '0.6';
        camposEndereco.style.pointerEvents = 'none';
    } else {
        camposEndereco.style.opacity = '1';
        camposEndereco.style.pointerEvents = 'auto';
        document.getElementById('localizacao_endereco').value = '';
        document.getElementById('localizacao_cidade').value = '';
        document.getElementById('localizacao_estado').value = '';
    }
}

// Sistema de navegação por seções
let currentStep = 1;
const totalSteps = 3;

function mostrarSecao(step) {
    if (step < 1 || step > totalSteps) return;

    for (let i = 1; i <= totalSteps; i++) {
        const secao = document.getElementById(`secao-${i}`);
        if (secao) {
            secao.style.display = i === step ? 'block' : 'none';
        }
    }

    atualizarProgresso(step);
    atualizarNavegacao(step);
    currentStep = step;

    // Scroll suave para o topo da seção
    window.scrollTo({top: 200, behavior: 'smooth'});
}

function atualizarProgresso(activeStep) {
    for (let i = 1; i <= totalSteps; i++) {
        const stepEl = document.getElementById(`step-${i}`);
        if (!stepEl) continue;

        const circle = stepEl.querySelector('div');
        const label = stepEl.querySelector('span');

        if (i <= activeStep) {
            if (i === 1) {
                circle.className = 'w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-full flex items-center justify-center font-bold text-sm shadow-lg';
                label.className = 'ml-3 text-sm font-medium text-green-600';
            } else if (i === 2) {
                circle.className = 'w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm shadow-lg';
                label.className = 'ml-3 text-sm font-medium text-blue-600';
            } else if (i === 3) {
                // Cor roxa para a seção 3
                circle.className = 'w-10 h-10 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-full flex items-center justify-center font-bold text-sm shadow-lg';
                label.className = 'ml-3 text-sm font-medium text-purple-600';
            }
        } else {
            circle.className = 'w-10 h-10 bg-gray-300 text-gray-500 rounded-full flex items-center justify-center font-bold text-sm';
            label.className = 'ml-3 text-sm font-medium text-gray-500';
        }
    }
}


function atualizarNavegacao(step) {
    const btnAnterior = document.getElementById('btnAnterior');
    const btnProximo = document.getElementById('btnProximo');
    const actionButtons = document.getElementById('actionButtons');

    btnAnterior.style.display = step > 1 ? 'flex' : 'none';

    if (step < totalSteps) {
        btnProximo.style.display = 'flex';
        actionButtons.style.display = 'none';
    } else {
        btnProximo.style.display = 'none';
        actionButtons.style.display = 'flex';
    }
}

function proximaSecao() {
    if (currentStep < totalSteps && validarSecaoAtual()) {
        mostrarSecao(currentStep + 1);
    }
}

function secaoAnterior() {
    if (currentStep > 1) {
        mostrarSecao(currentStep - 1);
    }
}

function validarSecaoAtual() {
    const secaoAtual = document.getElementById(`secao-${currentStep}`);
    if (!secaoAtual) return true;

    const camposObrigatorios = secaoAtual.querySelectorAll('input[required], select[required], textarea[required]');

    for (let campo of camposObrigatorios) {
        if (!campo.value.trim()) {
            campo.focus();
            campo.classList.add('border-red-500');
            setTimeout(() => campo.classList.remove('border-red-500'), 3000);
            showToast('Por favor, preencha todos os campos obrigatórios.', 'error');
            return false;
        }
    }

    // Validações específicas
    if (currentStep === 1) {
        const tipoVaga = document.getElementById('tipo_vaga').value;

        if ((tipoVaga === 'Presencial' || tipoVaga === 'Híbrida')) {
            const endereco = document.getElementById('localizacao_endereco').value;
            const cidade = document.getElementById('localizacao_cidade').value;
            const estado = document.getElementById('localizacao_estado').value;

            if (!endereco || !cidade || !estado) {
                showToast('Endereço é obrigatório para vagas presenciais/híbridas.', 'error');
                return false;
            }
        }
    }

    if (currentStep === 3) {
        const total = parseInt(document.getElementById('total-peso').textContent);
        if (total !== 100) {
            showToast('Os pesos devem somar exatamente 100%.', 'error');
            return false;
        }
    }

    return true;
}

function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    const bgColor = type === 'error' ? 'bg-red-500' : type === 'success' ? 'bg-green-500' : 'bg-blue-500';

    toast.className = `fixed bottom-4 right-4 z-50 px-6 py-4 rounded-xl shadow-lg text-white ${bgColor} transform translate-y-full transition-all duration-300`;
    toast.textContent = message;

    document.body.appendChild(toast);
    setTimeout(() => toast.classList.remove('translate-y-full'), 100);

    setTimeout(() => {
        toast.classList.add('translate-y-full');
        setTimeout(() => toast.remove(), 300);
    }, 3000);
}

// Funções para metodologia de score
function atualizarPeso(tipo, valor) {
    document.getElementById(`valor_${tipo}`).textContent = valor;
    calcularTotalPesos();
}

function calcularTotalPesos() {
    const pesos = ['salarial', 'requisitos', 'experiencia', 'diferenciais', 'localizacao', 'formacao'];
    let total = 0;
    
    pesos.forEach(peso => {
        total += parseInt(document.getElementById(`peso_${peso}`).value);
    });
    
    document.getElementById('total-peso').textContent = total;
    
    const statusPeso = document.getElementById('status-peso');
    const barraProgresso = document.getElementById('barra-progresso');
    
    if (total === 100) {
        statusPeso.textContent = '✅ Válido (100%)';
        statusPeso.className = 'text-sm font-bold text-green-600';
        barraProgresso.style.width = '100%';
        barraProgresso.className = 'bg-gradient-to-r from-green-500 to-emerald-500 h-3 rounded-full transition-all duration-300';
    } else if (total < 100) {
        statusPeso.textContent = `⚠️ Incompleto (${total}%)`;
        statusPeso.className = 'text-sm font-bold text-yellow-600';
        barraProgresso.style.width = `${total}%`;
        barraProgresso.className = 'bg-gradient-to-r from-yellow-500 to-orange-500 h-3 rounded-full transition-all duration-300';
    } else {
        statusPeso.textContent = `❌ Excesso (${total}%)`;
        statusPeso.className = 'text-sm font-bold text-red-600';
        barraProgresso.style.width = '100%';
        barraProgresso.className = 'bg-gradient-to-r from-red-500 to-red-600 h-3 rounded-full transition-all duration-300';
    }
}

function aplicarTemplateScore() {
    const template = document.getElementById('template_score').value;
    const templates = {
        'equilibrado': {salarial: 20, requisitos: 40, experiencia: 15, diferenciais: 10, localizacao: 10, formacao: 5},
        'tecnico': {salarial: 10, requisitos: 50, experiencia: 25, diferenciais: 10, localizacao: 5, formacao: 0},
        'startup': {salarial: 30, requisitos: 30, experiencia: 10, diferenciais: 20, localizacao: 10, formacao: 0},
        'tradicional': {salarial: 15, requisitos: 35, experiencia: 20, diferenciais: 5, localizacao: 15, formacao: 10},
        'remoto': {salarial: 25, requisitos: 45, experiencia: 20, diferenciais: 10, localizacao: 0, formacao: 0},
        'vendas': {salarial: 25, requisitos: 25, experiencia: 20, diferenciais: 20, localizacao: 10, formacao: 0},
        'gestao': {salarial: 15, requisitos: 30, experiencia: 30, diferenciais: 15, localizacao: 5, formacao: 5}
    };
    
    if (template && templates[template]) {
        Object.keys(templates[template]).forEach(peso => {
            const input = document.getElementById(`peso_${peso}`);
            input.value = templates[template][peso];
            atualizarPeso(peso, templates[template][peso]);
        });
    }
}

function resetarPesos() {
    const pesosDefault = {salarial: 20, requisitos: 40, experiencia: 15, diferenciais: 10, localizacao: 10, formacao: 5};
    Object.keys(pesosDefault).forEach(peso => {
        const input = document.getElementById(`peso_${peso}`);
        input.value = pesosDefault[peso];
        atualizarPeso(peso, pesosDefault[peso]);
    });
    document.getElementById('template_score').value = 'equilibrado';
}

// Inicialização
document.addEventListener('DOMContentLoaded', function() {
    mostrarSecao(1);
});
</script>
{% endblock %}