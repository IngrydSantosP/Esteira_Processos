<!-- Filtros e Busca -->
<link rel="stylesheet" href="{{ url_for('static', filename='style/vagas.css') }}">

<div class="filter-search-container">
    <div class="filter-search-box">
        <div class="filter-search-flex">
            <!-- Filtros -->
            <div class="filter-buttons">
                <button onclick="filtrarVagas('todas')" class="filter-btn active-filter">
                    Todas ({{ vagas|length if vagas else 0 }})
                </button>
                <button onclick="filtrarVagas('Ativa')" class="filter-btn">
                    Ativas ({{ vagas|selectattr('status', 'equalto', 'Ativa')|list|length if vagas else 0 }})
                </button>
                <button onclick="filtrarVagas('Congelada')" class="filter-btn">
                    Congeladas ({{ vagas|selectattr('status', 'equalto', 'Congelada')|list|length if vagas else 0 }})
                </button>
                <button onclick="filtrarVagas('Concluída')" class="filter-btn">
                    Concluídas ({{ vagas|selectattr('status', 'equalto', 'Concluída')|list|length if vagas else 0 }})
                </button>
            </div>

            <div class="create-job-flex">
                <a href="{{ url_for('vagas.criar_vaga') }}" class="create-job-btn">
                    <img src="{{ url_for('static', filename='/img/add.png') }}" class="emojis">
                </a>

                <!-- Botão Busca Inteligente -->
                <div class="search-btn-container">
                    <button id="toggleSearchBtn" onclick="toggleAdvancedSearch()" class="search-btn">
                        <img src="{{ url_for('static', filename='/img/lupa.png') }}" class="emojis">
                    </button>
                </div>
            </div>
        </div>

        <!-- Painel de Busca Avançada (inicialmente oculto) -->
        <div id="advancedSearchPanel" class="advanced-search-panel hidden">
            <div class="search-fields-container">
                <div class="search-field">
                    <img src="{{ url_for('static', filename='/img/lupa.png') }}" class="emojis"> Palavra-chave
                    <input type="text" id="searchKeyword" placeholder="Ex: desenvolvedor, vendas..." class="search-input">
                </div>

                <div class="search-field">
                    <img src="{{ url_for('static', filename='/img/status.png') }}" class="emojis"> Status
                    <select id="searchStatus" class="search-input">
                        <option value="">Todos os status</option>
                        <option value="Ativa">Ativa</option>
                        <option value="Congelada">Congelada</option>
                        <option value="Concluída">Concluída</option>
                    </select>
                </div>

                <div class="search-field">
                    <img src="{{ url_for('static', filename='/img/urgencia.png') }}" class="emojis"> Urgência
                    <select id="searchUrgency" class="search-input">
                        <option value="">Qualquer urgência</option>
                        <option value="Imediata">Imediata</option>
                        <option value="Em até 30 dias">Em até 30 dias</option>
                        <option value="Sem urgência">Sem urgência</option>
                    </select>
                </div>

                <div class="search-field">
                    <img src="{{ url_for('static', filename='/img/nothing.png') }}" class="emojis">Candidatos
                    <select id="searchCandidatos" class="search-input">
                        <option value="">Qualquer quantidade</option>
                        <option value="sem_candidatos">Sem candidatos</option>
                        <option value="poucos_candidatos">1-5 candidatos</option>
                        <option value="muitos_candidatos">5+ candidatos</option>
                    </select>
                </div>
            </div>

            <div class="search-actions">
                <button onclick="realizarBuscaVagas()" class="search-action-btn">
                    <img src="{{ url_for('static', filename='/img/lupa.png') }}" class="emojis">
                    Buscar Vagas
                </button>
                <button onclick="limparFiltrosBusca()" class="clear-filters-btn">
                    <img src="{{ url_for('static', filename='/img/clear.png') }}" class="emojis">
                    Limpar Filtros
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Lista de Vagas -->
{% include 'partials/lista_vagas.html' %}

<script>
function toggleAdvancedSearch() {
    const panel = document.getElementById("advancedSearchPanel");

    if (panel.classList.contains("hidden")) {
        panel.classList.remove("hidden");
        setTimeout(() => panel.classList.add("open"), 10); // transição suave
    } else {
        panel.classList.remove("open");
        setTimeout(() => panel.classList.add("hidden"), 300); // espera a transição
    }
}
</script>
